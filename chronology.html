<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è–ç¶“åˆ—ç‹ç·Šæ¹Šç‰ˆå¹´è¡¨ (å«ç¶“æ–‡ä½è­‰)</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        body {
            font-family: "Microsoft JhengHei", "Heiti TC", Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        
        #scroll-container {
            width: 100%;
            overflow-x: auto;
            border: 1px solid #ccc;
            background-color: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            padding: 20px 0; 
        }

        #chart-div {
            width: 3500px; 
            height: 1000px; 
        }

        .controls {
            margin-bottom: 10px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .verse-highlight {
            color: #2c3e50;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <div class="controls">
        <h2>ğŸ“œ è–ç¶“åˆ—ç‹å¹´è¡¨ (å«ç¶“æ–‡ä½è­‰)</h2>
        <p>ğŸ’¡ <b>æ“ä½œèªªæ˜</b>ï¼š
           1. <b>å·¦å³å·å‹•</b>ä¸‹æ–¹çš„å·è»¸æª¢è¦–å®Œæ•´æ™‚é–“è»¸ã€‚
           2. <b>æ»‘é¼ å·¦éµ</b>å¯æ‹–æ›³ç•«é¢ã€‚
           3. <b>æ»‘é¼ ç§»è‡³äººåä¸Š</b>ï¼Œæœƒé¡¯ç¤ºè©³ç´°å¹´ä»½èˆ‡<b>è–ç¶“ç¶“æ–‡å‡ºè™•</b>ã€‚</p>
    </div>

    <div id="scroll-container">
        <div id="chart-div"></div>
    </div>

    <script>
        // ==========================================
        // 1. åŸå§‹è³‡æ–™è¨­å®š (æ–°å¢ verse æ¬„ä½)
        // ==========================================
        const rawPeople = [
            // --- å‰µä¸–è¨˜/åˆ—ç¥–æ™‚æœŸ ---
            {name: "äºç•¶ (Adam)", birth_bc: -4004, lifespan: 930, color: "lightgray", type: "other", verse: "å‰µä¸–è¨˜ 5:5"},
            {name: "å¡ç‰¹ (Seth)", birth_bc: -3874, lifespan: 912, color: "lightgray", type: "other", verse: "å‰µä¸–è¨˜ 5:8"},
            {name: "ä»¥è«¾ (Enoch)", birth_bc: -3382, lifespan: 365, color: "lightgray", type: "other", verse: "å‰µä¸–è¨˜ 5:23"},
            {name: "ç‘ªåœŸæ’’æ‹‰ (Methuselah)", birth_bc: -3317, lifespan: 969, color: "lightgray", type: "other", verse: "å‰µä¸–è¨˜ 5:27"},
            {name: "æŒªäº (Noah)", birth_bc: -2948, lifespan: 950, color: "lightgray", type: "other", verse: "å‰µä¸–è¨˜ 9:29"},
            {name: "äºä¼¯æ‹‰ç½• (Abraham)", birth_bc: -2166, lifespan: 175, color: "wheat", type: "other", verse: "å‰µä¸–è¨˜ 25:7"},
            {name: "æ‘©è¥¿ (Moses)", birth_bc: -1527, lifespan: 120, color: "wheat", type: "other", verse: "ç”³å‘½è¨˜ 34:7"},
            {name: "ç´„æ›¸äº (Joshua)", birth_bc: -1490, lifespan: 110, color: "wheat", type: "other", verse: "ç´„æ›¸äºè¨˜ 24:29"},

            // --- å£«å¸«è¨˜æ™‚æœŸ ---
            {name: "ä¿„é™€è¶", birth_bc: -1370, lifespan: 40, note: "å£«å¸«40å¹´", color: "skyblue", type: "other", verse: "å£«å¸«è¨˜ 3:11"},
            {name: "ä»¥ç¬", birth_bc: -1330, lifespan: 80, note: "å£«å¸«80å¹´", color: "skyblue", type: "other", verse: "å£«å¸«è¨˜ 3:30"},
            {name: "çŠè¿¦", birth_bc: -1250, lifespan: 1, note: "å£«å¸«(<1å¹´)", color: "skyblue", type: "other", verse: "å£«å¸«è¨˜ 3:31"},
            {name: "åº•æ³¢æ‹‰", birth_bc: -1249, lifespan: 40, note: "å£«å¸«40å¹´", color: "skyblue", type: "other", verse: "å£«å¸«è¨˜ 5:31"},
            {name: "åŸºç”¸", birth_bc: -1209, lifespan: 40, note: "å£«å¸«40å¹´", color: "skyblue", type: "other", verse: "å£«å¸«è¨˜ 8:28"},
            {name: "äºæ¯”ç±³å‹’", birth_bc: -1169, lifespan: 3, note: "ç¯¡ä½3å¹´", color: "gray", type: "other", verse: "å£«å¸«è¨˜ 9:22"},
            {name: "é™€æ‹‰", birth_bc: -1166, lifespan: 23, note: "å£«å¸«23å¹´", color: "skyblue", type: "other", verse: "å£«å¸«è¨˜ 10:2"},
            {name: "çšç¥", birth_bc: -1143, lifespan: 22, note: "å£«å¸«22å¹´", color: "skyblue", type: "other", verse: "å£«å¸«è¨˜ 10:3"},
            {name: "è€¶å¼—ä»–", birth_bc: -1121, lifespan: 6, note: "å£«å¸«6å¹´", color: "skyblue", type: "other", verse: "å£«å¸«è¨˜ 12:7"},
            {name: "ä»¥æ¯”è®š", birth_bc: -1115, lifespan: 7, note: "å£«å¸«7å¹´", color: "skyblue", type: "other", verse: "å£«å¸«è¨˜ 12:9"},
            {name: "ä»¥å€«", birth_bc: -1108, lifespan: 10, note: "å£«å¸«10å¹´", color: "skyblue", type: "other", verse: "å£«å¸«è¨˜ 12:11"},
            {name: "æŠ¼é “", birth_bc: -1098, lifespan: 8, note: "å£«å¸«8å¹´", color: "skyblue", type: "other", verse: "å£«å¸«è¨˜ 12:14"},
            {name: "åƒå­«", birth_bc: -1090, lifespan: 20, note: "å£«å¸«20å¹´", color: "skyblue", type: "other", verse: "å£«å¸«è¨˜ 16:31"},
            {name: "æ’’æ¯è€³", birth_bc: -1105, lifespan: 88, note: "å£«å¸«/å…ˆçŸ¥", color: "plum", type: "other", verse: "æ’’æ¯è€³è¨˜ä¸Š 7:15"}, 

            // --- çµ±ä¸€ç‹åœ‹ (ç¶“æ–‡ä½è­‰) ---
            {name: "æƒç¾…", birth_bc: -1050, lifespan: 40, note: "çµ±ä¸€ç‹åœ‹40å¹´", color: "gold", type: "king", verse: "ä½¿å¾’è¡Œå‚³ 13:21 (èˆŠç´„æœªæ˜è¨˜ç¸½å¹´æ•¸)"},
            {name: "å¤§è¡›", birth_bc: -1010, lifespan: 40, note: "çµ±ä¸€ç‹åœ‹40å¹´", color: "gold", type: "king", verse: "æ’’æ¯è€³è¨˜ä¸‹ 5:4"},
            {name: "æ‰€ç¾…é–€", birth_bc: -970, lifespan: 40, note: "çµ±ä¸€ç‹åœ‹40å¹´", color: "gold", type: "king", verse: "åˆ—ç‹ç´€ä¸Š 11:42"},

            // --- å—åœ‹çŒ¶å¤§ (åŠ å…¥ç¶“æ–‡) ---
            {name: "ç¾…æ³¢å®‰", birth_bc: -931, lifespan: 17, note: "çŒ¶å¤§17å¹´", color: "orange", type: "king", verse: "ç‹ä¸Š 14:21 æ‰€ç¾…é–€çš„å…’å­ç¾…æ³¢å®‰ä½œçŒ¶å¤§ç‹ã€‚ä»–ç™»åŸºçš„æ™‚å€™å¹´å››åä¸€æ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ï¼Œå°±æ˜¯è€¶å’Œè¯å¾ä»¥è‰²åˆ—çœ¾æ”¯æ´¾ä¸­æ‰€é¸æ“‡ç«‹ä»–åçš„åŸï¼Œä½œç‹åä¸ƒå¹´ã€‚ç¾…æ³¢å®‰çš„æ¯è¦ªåå«æ‹¿ç‘ªï¼Œæ˜¯äºæ«äººã€‚"},
            {name: "äºæ¯”å¤®", birth_bc: -913, lifespan: 3, note: "çŒ¶å¤§3å¹´", color: "orange", type: "king", verse: "ç‹ä¸Š 15:2 åœ¨è€¶è·¯æ’’å†·ä½œç‹ä¸‰å¹´ã€‚ä»–æ¯è¦ªåå«ç‘ªè¿¦ï¼Œæ˜¯æŠ¼æ²™é¾çš„å¥³å…’ã€‚"},
            {name: "äºæ’’", birth_bc: -911, lifespan: 41, note: "çŒ¶å¤§41å¹´", color: "orange", type: "king", verse: "ç‹ä¸Š 15:10 åœ¨è€¶è·¯æ’’å†·ä½œç‹å››åä¸€å¹´ã€‚ä»–ç¥–æ¯åå«ç‘ªè¿¦ï¼Œæ˜¯æŠ¼æ²™é¾çš„å¥³å…’ã€‚"},
            {name: "ç´„æ²™æ³•", birth_bc: -870, lifespan: 25, note: "çŒ¶å¤§25å¹´", color: "orange", type: "king", verse: "ç‹ä¸Š 22:42 ç´„æ²™æ³•ç™»åŸºçš„æ™‚å€™å¹´ä¸‰åäº”æ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹äºŒåäº”å¹´ã€‚ä»–æ¯è¦ªåå«é˜¿è˜‡å·´ï¼Œä¹ƒç¤ºåˆ©å¸Œçš„å¥³å…’ã€‚"},
            {name: "ç´„è˜­(çŒ¶)", birth_bc: -848, lifespan: 8, note: "çŒ¶å¤§8å¹´", color: "orange", type: "king", verse: "ç‹ä¸‹ 8:17 ç´„è˜­ç™»åŸºçš„æ™‚å€™å¹´ä¸‰åäºŒæ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹å…«å¹´ã€‚"},
            {name: "äºå“ˆè¬(çŒ¶)", birth_bc: -841, lifespan: 1, note: "çŒ¶å¤§1å¹´", color: "orange", type: "king", verse: "ç‹ä¸‹ 8:26 ä»–ç™»åŸºçš„æ™‚å€™å¹´äºŒåäºŒæ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹ä¸€å¹´ã€‚ä»–æ¯è¦ªåå«äºä»–åˆ©é›…ï¼Œæ˜¯ä»¥è‰²åˆ—ç‹æš—åˆ©çš„å­«å¥³ã€‚"},
            {name: "äºä»–åˆ©é›…", birth_bc: -841, lifespan: 6, note: "ç¯¡ä½6å¹´", color: "red", type: "king", verse: "ç‹ä¸‹ 11:3 ç´„é˜¿æ–½å’Œä»–çš„ä¹³æ¯è—åœ¨è€¶å’Œè¯çš„æ®¿è£¡å…­å¹´ï¼›äºä»–åˆ©é›…ç¯¡äº†åœ‹ä½ã€‚"},
            {name: "ç´„é˜¿æ–½(çŒ¶)", birth_bc: -835, lifespan: 40, note: "çŒ¶å¤§40å¹´", color: "orange", type: "king", verse: "ç‹ä¸‹ 12:1 è€¶æˆ¶ç¬¬ä¸ƒå¹´ï¼Œç´„é˜¿æ–½ç™»åŸºï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹å››åå¹´ã€‚ä»–æ¯è¦ªåå«è¥¿æ¯”äºï¼Œæ˜¯åˆ¥æ˜¯å·´äººã€‚"},
            {name: "äºç‘ªè¬", birth_bc: -796, lifespan: 29, note: "çŒ¶å¤§29å¹´", color: "orange", type: "king", verse: "ç‹ä¸‹ 14:2 ä»–ç™»åŸºçš„æ™‚å€™å¹´äºŒåäº”æ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹äºŒåä¹å¹´ã€‚ä»–æ¯è¦ªåå«ç´„è€¶ä½†ï¼Œæ˜¯è€¶è·¯æ’’å†·äººã€‚"},
            {name: "çƒè¥¿é›…", birth_bc: -767, lifespan: 52, note: "çŒ¶å¤§52å¹´", color: "orange", type: "king", verse: "ç‹ä¸‹ 15:2 (åˆåäºæ’’åˆ©é›…) ä»–ç™»åŸºçš„æ™‚å€™å¹´åå…­æ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹äº”åäºŒå¹´ã€‚ä»–æ¯è¦ªåå«è€¶å¯åˆ©é›…ï¼Œæ˜¯è€¶è·¯æ’’å†·äººã€‚"},
            {name: "ç´„å¦", birth_bc: -740, lifespan: 16, note: "çŒ¶å¤§16å¹´", color: "orange", type: "king", verse: "ç‹ä¸‹ 15:33 ä»–ç™»åŸºçš„æ™‚å€™å¹´äºŒåäº”æ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹åå…­å¹´ã€‚ä»–æ¯è¦ªåå«è€¶è·¯æ²™ï¼Œæ˜¯æ’’ç£çš„å¥³å…’ã€‚"},
            {name: "äºå“ˆæ–¯", birth_bc: -732, lifespan: 16, note: "çŒ¶å¤§16å¹´", color: "orange", type: "king", verse: "ç‹ä¸‹ 16:2 ä»–ç™»åŸºçš„æ™‚å€™å¹´äºŒåæ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹åå…­å¹´ï¼›ä¸åƒä»–ç¥–å¤§è¡›è¡Œè€¶å’Œè¯â”€ä»–ã€€ç¥çœ¼ä¸­çœ‹ç‚ºæ­£çš„äº‹ï¼Œ"},
            {name: "å¸Œè¥¿å®¶", birth_bc: -716, lifespan: 29, note: "çŒ¶å¤§29å¹´", color: "orange", type: "king", verse: "ç‹ä¸‹ 18:2 ä»–ç™»åŸºçš„æ™‚å€™å¹´äºŒåäº”æ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹äºŒåä¹å¹´ã€‚ä»–æ¯è¦ªåå«äºæ¯”ï¼Œæ˜¯æ’’è¿¦åˆ©é›…çš„å¥³å…’ã€‚"},
            {name: "ç‘ªæ‹¿è¥¿", birth_bc: -687, lifespan: 55, note: "çŒ¶å¤§55å¹´", color: "orange", type: "king", verse: "ç‹ä¸‹ 21:1 ç‘ªæ‹¿è¥¿ç™»åŸºçš„æ™‚å€™å¹´åäºŒæ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹äº”åäº”å¹´ã€‚ä»–æ¯è¦ªåå«å”è¥¿å·´ã€‚"},
            {name: "äºå€‘", birth_bc: -642, lifespan: 2, note: "çŒ¶å¤§2å¹´", color: "orange", type: "king", verse: "ç‹ä¸‹ 21:19 äºå€‘ç™»åŸºçš„æ™‚å€™å¹´äºŒåäºŒæ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹äºŒå¹´ã€‚ä»–æ¯è¦ªåå«ç±³èˆ’åˆ©å¯†ï¼Œæ˜¯ç´„æå·´äººå“ˆé­¯æ–¯çš„å¥³å…’ã€‚"},
            {name: "ç´„è¥¿äº", birth_bc: -640, lifespan: 31, note: "çŒ¶å¤§31å¹´", color: "orange", type: "king", verse: "ç‹ä¸‹ 22:1 ç´„è¥¿äºç™»åŸºçš„æ™‚å€™å¹´å…«æ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹ä¸‰åä¸€å¹´ã€‚ä»–æ¯è¦ªåå«è€¶åº•å¤§ï¼Œæ˜¯æ³¢æ–¯åŠ äººäºå¤§é›…çš„å¥³å…’ã€‚"},
            {name: "ç´„å“ˆæ–¯(çŒ¶)", birth_bc: -609, lifespan: 0.25, note: "3å€‹æœˆ", color: "orange", type: "king", verse: "ç‹ä¸‹ 23:31 ç´„å“ˆæ–¯ç™»åŸºçš„æ™‚å€™å¹´äºŒåä¸‰æ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹ä¸‰å€‹æœˆã€‚ä»–æ¯è¦ªåå«å“ˆæ…•ä»–ï¼Œæ˜¯ç«‹æ‹¿äººè€¶åˆ©ç±³çš„å¥³å…’ã€‚"},
            {name: "ç´„é›…æ•¬", birth_bc: -609, lifespan: 11, note: "çŒ¶å¤§11å¹´", color: "orange", type: "king", verse: "ç‹ä¸‹ 23:36 ç´„é›…æ•¬ç™»åŸºçš„æ™‚å€™å¹´äºŒåäº”æ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹åä¸€å¹´ã€‚ä»–æ¯è¦ªåå«è¥¿å¸ƒå¤§ï¼Œæ˜¯é­¯ç‘ªäººæ¯˜å¤§é›…çš„å¥³å…’ã€‚"},
            {name: "ç´„é›…æ–¤", birth_bc: -598, lifespan: 0.25, note: "3å€‹æœˆ", color: "orange", type: "king", verse: "ç‹ä¸‹ 24:8 ç´„é›…æ–¤ç™»åŸºçš„æ™‚å€™å¹´åå…«æ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹ä¸‰å€‹æœˆã€‚ä»–æ¯è¦ªåå«å°¼è­·æ–½ä»–ï¼Œæ˜¯è€¶è·¯æ’’å†·äººä»¥åˆ©æ‹¿å–®çš„å¥³å…’ã€‚"},
            {name: "è¥¿åº•å®¶", birth_bc: -597, lifespan: 11, note: "æœ«ç‹11å¹´", color: "orange", type: "king", verse: "ç‹ä¸‹ 24:18 è¥¿åº•å®¶ç™»åŸºçš„æ™‚å€™å¹´äºŒåä¸€æ­²ï¼Œåœ¨è€¶è·¯æ’’å†·ä½œç‹åä¸€å¹´ã€‚ä»–æ¯è¦ªåå«å“ˆæ…•ä»–ï¼Œæ˜¯ç«‹æ‹¿äººè€¶åˆ©ç±³çš„å¥³å…’ã€‚"},

            // --- åŒ—åœ‹ä»¥è‰²åˆ— (åŠ å…¥ç¶“æ–‡) ---
            {name: "è€¶ç¾…æ³¢å®‰ä¸€ä¸–", birth_bc: -931, lifespan: 22, note: "ä»¥è‰²åˆ—22å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸Š 14:20 è€¶ç¾…æ³¢å®‰ä½œç‹äºŒåäºŒå¹´ï¼Œå°±èˆ‡ä»–åˆ—ç¥–åŒç¡ã€‚ä»–å…’å­æ‹¿ç­”æ¥çºŒä»–ä½œç‹ã€‚"},
            {name: "æ‹¿ç­”", birth_bc: -910, lifespan: 2, note: "ä»¥è‰²åˆ—2å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸Š 15:25 çŒ¶å¤§ç‹äºæ’’ç¬¬äºŒå¹´ï¼Œè€¶ç¾…æ³¢å®‰çš„å…’å­æ‹¿ç­”ç™»åŸºä½œä»¥è‰²åˆ—ç‹å…±äºŒå¹´ï¼Œ"},
            {name: "å·´æ²™", birth_bc: -909, lifespan: 24, note: "ä»¥è‰²åˆ—24å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸Š 15:33 çŒ¶å¤§ç‹äºæ’’ç¬¬ä¸‰å¹´ï¼Œäºå¸Œé›…çš„å…’å­å·´æ²™åœ¨å¾—æ’’ç™»åŸºä½œä»¥è‰²åˆ—çœ¾äººçš„ç‹å…±äºŒåå››å¹´ã€‚"},
            {name: "ä»¥æ‹‰", birth_bc: -886, lifespan: 2, note: "ä»¥è‰²åˆ—2å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸Š 16:8 çŒ¶å¤§ç‹äºæ’’äºŒåå…­å¹´ï¼Œå·´æ²™çš„å…’å­ä»¥æ‹‰åœ¨å¾—æ’’ç™»åŸºä½œä»¥è‰²åˆ—ç‹å…±äºŒå¹´ã€‚"},
            {name: "å¿ƒåˆ©", birth_bc: -885, lifespan: 0.05, note: "7å¤©", color: "lightgreen", type: "king", verse: "ç‹ä¸Š 16:15 çŒ¶å¤§ç‹äºæ’’äºŒåä¸ƒå¹´ï¼Œå¿ƒåˆ©åœ¨å¾—æ’’ä½œç‹ä¸ƒæ—¥ã€‚é‚£æ™‚æ°‘æ­£å®‰ç‡Ÿåœæ”»éåˆ©å£«çš„åŸºæ¯”é “ã€‚"},
            {name: "æš—åˆ©", birth_bc: -885, lifespan: 12, note: "ä»¥è‰²åˆ—12å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸Š 16:23 çŒ¶å¤§ç‹äºæ’’ä¸‰åä¸€å¹´ï¼Œæš—åˆ©ç™»åŸºä½œä»¥è‰²åˆ—ç‹å…±åäºŒå¹´ï¼›åœ¨å¾—æ’’ä½œç‹å…­å¹´ã€‚"},
            {name: "äºå“ˆ", birth_bc: -874, lifespan: 22, note: "ä»¥è‰²åˆ—22å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸Š 16:29 çŒ¶å¤§ç‹äºæ’’ä¸‰åå…«å¹´ï¼Œæš—åˆ©çš„å…’å­äºå“ˆç™»åŸºä½œäº†ä»¥è‰²åˆ—ç‹ã€‚æš—åˆ©çš„å…’å­äºå“ˆåœ¨æ’’ç‘ªåˆ©äºä½œä»¥è‰²åˆ—ç‹äºŒåäºŒå¹´ã€‚"},
            {name: "äºå“ˆè¬(ä»¥)", birth_bc: -853, lifespan: 2, note: "ä»¥è‰²åˆ—2å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸Š 22:51 çŒ¶å¤§ç‹ç´„æ²™æ³•åä¸ƒå¹´ï¼Œäºå“ˆçš„å…’å­äºå“ˆè¬åœ¨æ’’ç‘ªåˆ©äºç™»åŸºï¼Œä½œä»¥è‰²åˆ—ç‹å…±äºŒå¹´ã€‚"},
            {name: "ç´„è˜­(ä»¥)", birth_bc: -852, lifespan: 12, note: "ä»¥è‰²åˆ—12å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸‹ 3:1 çŒ¶å¤§ç‹ç´„æ²™æ³•åå…«å¹´ï¼Œäºå“ˆçš„å…’å­ç´„è˜­åœ¨æ’’ç‘ªåˆ©äºç™»åŸºä½œäº†ä»¥è‰²åˆ—ç‹åäºŒå¹´ã€‚"},
            {name: "è€¶æˆ¶", birth_bc: -841, lifespan: 28, note: "ä»¥è‰²åˆ—28å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸‹ 10:36 è€¶æˆ¶åœ¨æ’’ç‘ªåˆ©äºä½œä»¥è‰²åˆ—ç‹äºŒåå…«å¹´ã€‚"},
            {name: "ç´„å“ˆæ–¯(ä»¥)", birth_bc: -814, lifespan: 17, note: "ä»¥è‰²åˆ—17å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸‹ 13:1 çŒ¶å¤§ç‹äºå“ˆè¬çš„å…’å­ç´„é˜¿æ–½äºŒåä¸‰å¹´ï¼Œè€¶æˆ¶çš„å…’å­ç´„å“ˆæ–¯åœ¨æ’’ç‘ªåˆ©äºç™»åŸºä½œä»¥è‰²åˆ—ç‹åä¸ƒå¹´ã€‚"},
            {name: "ç´„é˜¿æ–½(ä»¥)", birth_bc: -798, lifespan: 16, note: "ä»¥è‰²åˆ—16å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸‹ 13:10 çŒ¶å¤§ç‹ç´„é˜¿æ–½ä¸‰åä¸ƒå¹´ï¼Œç´„å“ˆæ–¯çš„å…’å­ç´„é˜¿æ–½åœ¨æ’’ç‘ªåˆ©äºç™»åŸºä½œä»¥è‰²åˆ—ç‹åå…­å¹´ã€‚"},
            {name: "è€¶ç¾…æ³¢å®‰äºŒä¸–", birth_bc: -782, lifespan: 41, note: "ä»¥è‰²åˆ—41å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸‹ 14:23 çŒ¶å¤§ç‹ç´„é˜¿æ–½çš„å…’å­äºç‘ªè¬åäº”å¹´ï¼Œä»¥è‰²åˆ—ç‹ç´„é˜¿æ–½çš„å…’å­è€¶ç¾…æ³¢å®‰åœ¨æ’’ç‘ªåˆ©äºç™»åŸºï¼Œä½œç‹å››åä¸€å¹´ã€‚"},
            {name: "æ’’è¿¦åˆ©äº", birth_bc: -753, lifespan: 0.5, note: "6å€‹æœˆ", color: "lightgreen", type: "king", verse: "ç‹ä¸‹ 15:8 çŒ¶å¤§ç‹äºæ’’åˆ©é›…ä¸‰åå…«å¹´ï¼Œè€¶ç¾…æ³¢å®‰çš„å…’å­æ’’è¿¦åˆ©é›…åœ¨æ’’ç‘ªåˆ©äºä½œä»¥è‰²åˆ—ç‹å…­å€‹æœˆã€‚"},
            {name: "æ²™é¾", birth_bc: -752, lifespan: 0.08, note: "1å€‹æœˆ", color: "lightgreen", type: "king", verse: "ç‹ä¸‹ 15:13 çŒ¶å¤§ç‹çƒè¥¿é›…(å°±æ˜¯äºæ’’åˆ©é›…)ä¸‰åä¹å¹´ï¼Œé›…æ¯”çš„å…’å­æ²™é¾ç™»åŸºåœ¨æ’’ç‘ªåˆ©äºä½œç‹ä¸€å€‹æœˆã€‚"},
            {name: "ç±³æ‹¿ç¾", birth_bc: -752, lifespan: 10, note: "ä»¥è‰²åˆ—10å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸‹ 15:17 çŒ¶å¤§ç‹äºæ’’åˆ©é›…ä¸‰åä¹å¹´ï¼Œè¿¦åº•çš„å…’å­ç±³æ‹¿ç¾ç™»åŸºï¼Œåœ¨æ’’ç‘ªåˆ©äºä½œä»¥è‰²åˆ—ç‹åå¹´ã€‚"},
            {name: "æ¯”åŠ è½„", birth_bc: -742, lifespan: 2, note: "ä»¥è‰²åˆ—2å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸‹ 15:23 çŒ¶å¤§ç‹äºæ’’åˆ©é›…äº”åå¹´ï¼Œç±³æ‹¿ç¾çš„å…’å­æ¯”åŠ è½„åœ¨æ’’ç‘ªåˆ©äºç™»åŸºä½œä»¥è‰²åˆ—ç‹äºŒå¹´ã€‚"},
            {name: "æ¯”åŠ ", birth_bc: -740, lifespan: 20, note: "ä»¥è‰²åˆ—20å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸‹ 15:27 çŒ¶å¤§ç‹äºæ’’åˆ©é›…äº”åäºŒå¹´ï¼Œåˆ©ç‘ªåˆ©çš„å…’å­æ¯”åŠ åœ¨æ’’ç‘ªåˆ©äºç™»åŸºä½œä»¥è‰²åˆ—ç‹äºŒåå¹´ã€‚"},
            {name: "ä½•ç´°äº", birth_bc: -732, lifespan: 9, note: "æœ«ç‹9å¹´", color: "lightgreen", type: "king", verse: "ç‹ä¸‹ 17:1 çŒ¶å¤§ç‹äºå“ˆæ–¯åäºŒå¹´ï¼Œä»¥æ‹‰çš„å…’å­ä½•ç´°äºåœ¨æ’’ç‘ªåˆ©äºç™»åŸºä½œä»¥è‰²åˆ—ç‹ä¹å¹´ã€‚"}
        ];

        // ==========================================
        // 2. è³‡æ–™è™•ç†æ ¸å¿ƒé‚è¼¯ (è¨ˆç®—é‡ç–Š + ç”¢ç”Ÿè©³ç´°æ‡¸åœæ–‡å­—)
        // ==========================================
        const others = rawPeople.filter(p => p.type === 'other');
        let kings = rawPeople.filter(p => p.type === 'king');

        kings.sort((a, b) => a.birth_bc - b.birth_bc);

        function processKingsWithOverlaps(sortedKings) {
            let tracks = []; 
            let processedKings = [];

            sortedKings.forEach(king => {
                let start = king.birth_bc;
                let end = king.birth_bc + king.lifespan;
                let placed = false;

                for (let i = 0; i < tracks.length; i++) {
                    if (tracks[i] <= start) {
                        king.trackIndex = i; 
                        tracks[i] = end;    
                        placed = true;
                        break;
                    }
                }

                if (!placed) {
                    king.trackIndex = tracks.length;
                    tracks.push(end);
                }
                processedKings.push(king);
            });
            return processedKings;
        }

        kings = processKingsWithOverlaps(kings);

        // --- æº–å‚™ç¹ªåœ–è³‡æ–™ ---
        let finalY = [];
        let finalX = [];
        let finalBase = [];
        let finalColors = [];
        let finalTexts = [];
        let finalHoverTexts = [];
        let finalTextAngles = [];
        let finalPositions = [];

        // å…±ç”¨çš„æ‡¸åœæ–‡å­—ç”¢ç”Ÿå™¨
        function createHoverText(p, extraInfo = "") {
            const endYear = Math.round(p.birth_bc + p.lifespan);
            let text = `<b>${p.name}</b><br>ğŸ“… å¹´ä»½: ${p.birth_bc} ~ ${endYear} BC<br>â±ï¸ åœ¨ä½/å£½å‘½: ${p.note || p.lifespan + 'å¹´'}`;
            // ğŸ’¡ é€™è£¡åŠ ä¸Šç¶“æ–‡é¡¯ç¤º
            if (p.verse) {
                text += `<br>ğŸ“– ç¶“æ–‡: ${p.verse}`;
            }
            if (extraInfo) {
                text += `<br>${extraInfo}`;
            }
            return text;
        }

        // 1. è™•ç†éåœ‹ç‹è³‡æ–™
        others.forEach(p => {
            finalY.push(p.name); 
            finalX.push(p.lifespan);
            finalBase.push(p.birth_bc);
            finalColors.push(p.color);
            finalTexts.push(p.note ? p.note : `${p.lifespan}æ­²`);
            
            finalHoverTexts.push(createHoverText(p));
            
            finalTextAngles.push(0); 
            finalPositions.push('outside'); 
        });

        // 2. è™•ç†åœ‹ç‹è³‡æ–™
        kings.forEach(p => {
            let indent = "ã€€".repeat(p.trackIndex);
            finalY.push(`${indent}çµ±åˆåˆ—ç‹æ™‚æœŸ (ç¬¬${p.trackIndex + 1}å±¤)`);
            
            finalX.push(p.lifespan);
            finalBase.push(p.birth_bc);
            finalColors.push(p.color);
            finalTexts.push(p.name); 
            
            // åœ‹ç‹å¤šé¡¯ç¤ºä¸€å€‹å±¤ç´šè³‡è¨Š
            finalHoverTexts.push(createHoverText(p, `(ç¬¬${p.trackIndex + 1}å±¤)`));
            
            finalTextAngles.push(-90); 
            finalPositions.push('inside'); 
        });


        // ==========================================
        // 3. Plotly ç¹ªåœ–è¨­å®š
        // ==========================================
        const trace = {
            type: 'bar',
            x: finalX,
            y: finalY,
            base: finalBase,
            orientation: 'h',
            marker: {
                color: finalColors,
                line: { color: 'black', width: 0.5 }
            },
            text: finalTexts,
            textangle: finalTextAngles,
            textposition: finalPositions,
            insidetextanchor: 'middle', 
            hoverinfo: 'text',
            hovertext: finalHoverTexts,
            width: 0.8 
        };

        const layout = {
            title: 'è–ç¶“åˆ—ç‹ç·Šæ¹Šç‰ˆå¹´è¡¨ (å«ç¶“æ–‡ä½è­‰)',
            dragmode: 'pan', 
            xaxis: {
                title: 'è¥¿å…ƒå‰å¹´ä»½ (BC)',
                range: [-4200, -500],
                dtick: 100,
                side: 'top',
                gridcolor: '#eee',
                zeroline: false,
                layer: 'below traces'
            },
            yaxis: {
                autorange: 'reversed', 
                automargin: true,
                title: { standoff: 20 } 
            },
            barmode: 'stack',
            hovermode: 'closest',
            margin: {
                l: 220, 
                r: 50,
                t: 100,
                b: 50
            },
            font: { size: 13 }
        };

        const config = {
            responsive: true,
            scrollZoom: true,
            displayModeBar: true,
            modeBarButtonsToRemove: ['select2d', 'lasso2d', 'autoScale2d']
        };

        Plotly.newPlot('chart-div', [trace], layout, config);

    </script>
</body>
</html>